
% Created by Yan Zhang (2008)
%
% It includes elements created by Like Gao (most of skeleton stuff)
%  -- ProQuest abstract environment
%  -- adjustments to meet the Graduate College expectations for the TOC
%
% Dissertation style file by Yan Zhang.
% Attempts to meet requirements of Univ. of Vermont
% No guarentees - PLEASE CHECK FORMAT CAREFULLY!
% 
% Page setup (8 1/2 x 11 double spaced page, for 11pt)
% 1.5 Left margin
% 1.0 right, top and bottom margins
% 
\setlength{\textwidth}{6.0in}
\setlength{\textheight}{8.5in}
\setlength{\topmargin}{0.1in}%-0.75in}
\setlength{\oddsidemargin}{0.5in}
\setlength{\evensidemargin}{0.5in}
\setlength{\headheight}{0.0in}
\setlength{\headsep}{0.0in}
%\setlength{\topskip}{0in}

%% %Define singlespace and doublespace commands for 10-12pt fonts.
%%     * One and one half spacing:
%%           o 10pt document: 1.25
%%           o 11pt: 1.21
%%           o 12pt: 1.24 
%%     * Double spacing:
%%           o 10pt document: 1.67
%%           o 11pt: 1.62
%%           o 12pt: 1.66 

\newcommand{\doublespace} {
  \renewcommand{\baselinestretch}{1.66}\small\normalsize
}
\newcommand{\oneandhalfspace} {
  \renewcommand{\baselinestretch}{1.21}\small\normalsize
}
\newcommand{\singlespace} {
  \renewcommand{\baselinestretch}{1}\small\normalsize
}
\oneandhalfspace
\newcommand{\labeltoc}[1]{
  \addtocontents{toc}
  {\protect\par\vspace*{0.5\baselineskip}
    \par{\noindent\bfseries #1\vspace{-0.5\baselineskip}}\par}}

% Change ``Bibliography'' to ``References''
\renewcommand{\bibname}{References}

% Graduate Colloge wants ``Table of Contents''
\renewcommand{\contentsname}{Table of Contents}

% Put ellipses in chapter listings.
\renewcommand*\l@chapter[2]{%
  \ifnum \c@tocdepth >\m@ne
    \addpenalty{-\@highpenalty}%
    \vskip 1.0em \@plus\p@
    \setlength\@tempdima{1.5em}%
    \begingroup
      \parindent \z@ \rightskip \@pnumwidth
      \parfillskip -\@pnumwidth
      \leavevmode \bfseries
      \advance\leftskip\@tempdima
      \hskip -\leftskip
      #1\nobreak\dotfill\nobreak\hb@xt@\@pnumwidth{\hss #2}\par
      \penalty\@highpenalty
    \endgroup
  \fi}

% Put ellipses in chapter listings.
\newcommand*\l@chapterfoo[2]{%
  \ifnum \c@tocdepth >\m@ne
    \addpenalty{-\@highpenalty}%
    \vskip 1.0em \@plus\p@
    \setlength\@tempdima{1.5em}%
    \begingroup
      \parindent \z@ \rightskip \@pnumwidth
      \parfillskip -\@pnumwidth
      \leavevmode \bfseries
      \advance\leftskip\@tempdima
      \hskip -\leftskip
      #1\nobreak\hfill\nobreak\hb@xt@\@pnumwidth{\hss #2}\par
      \penalty\@highpenalty
    \endgroup
  \fi}

%
% \maketitle is redefined to make the required title page
% Standard commands: \title, \author, \begin{abstract}, \end{abstract}
% New commands: \prevdegrees, \gradyear, \advisor
% Example:  \title{Phases of the electron-hole plasma}
%           \author{John Beaumont Shumway, Jr}
%           \advisor{David M. Ceperley}
%           \prevdegrees{B.S., University of Missouri-Columbia, 1993\\
%                        M.S., University of Missouri-Columbia, 1995}
%           \gradyear{1999}
% 
%
% Define "\prevdegrees" command for title page.
%
%\newcommand{\prevdegrees}[1]{\renewcommand{\@prevdegrees}{#1}}
%\newcommand{\@prevdegrees}{\tt$\backslash$\string prevdegrees}
%default is "\prevdegrees"
%
% Define "\gradyear" command for title page.
%
\newcommand{\gradyear}[1]{\renewcommand{\@gradyear}{#1}}
\newcommand{\@gradyear}{\tt$\backslash$\string gradyear}
%default is "\gradyear"
%
%\newcommand{\gradmonth}[1]{\renewcommand{\@gradmonth}{#1}}
%\newcommand{\@gradmonth}{\tt$\backslash$\string gradmonth}

% Define "\advisor" command for abstract.
%

\def\thesis{\gdef\@thesistype{A Thesis}}
\def\dissertation{\gdef\@thesistype{A Dissertation}}
\def\masterarts{\gdef\@degreetype{Master of Arts}}
\def\masterscience{\gdef\@degreetype{Master of Science}}
\def\doctorphilosophy{\gdef\@degreetype{Doctor of Philosophy}}

\def\cs{\gdef\@spectype{Computer Science}}

\def\octgrad{\gdef\@gradmonth{October}}
\def\jangrad{\gdef\@gradmonth{January}}
\def\margrad{\gdef\@gradmonth{March}}
\def\maygrad{\gdef\@gradmonth{May}}

%% Commands to define the defense committee.
\newcommand\advisor[1]{\gdef\@advisor{#1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% If you have co-advisors, you may define:
%\newcommand\coadvisorone[1]{\gdef\@coadvisorone{#1}} 
%\newcommand\coadvisortwo[1]{\gdef\@coadvisortwo{#1}}
%%  And you need to adjust "Thesis Examination Committee:" part in this style file accordingly
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand\readerone[1]{\gdef\@readerone{#1}}
\newcommand\readertwo[1]{\gdef\@readertwo{#1}}
\newcommand\chair[1]{\gdef\@chair{#1}}

\newcommand\defensedate[1]{\gdef\@defensedate{#1}}

%\newcommand{\advisor}[1]{\renewcommand{\@advisor}{#1}}
%\newcommand{\@advisor}{\tt$\backslash$\string advisor}
%default is "\advisor"
%
% Redefine maketitle
%
\renewcommand\maketitle{
  \thispagestyle{empty}
  %We need do determine TitleBoxHeight=1.75in-the height of capital letters.
  \newlength{\TitleBoxHeight}\settoheight{\TitleBoxHeight}{DISSERTATION}
  \setlength{\TitleBoxHeight}{-1.0\TitleBoxHeight}
  \addtolength{\TitleBoxHeight}{1.75in}
  %
  %Start from 0.75in top margin
  %
  \vspace*{1.5in}
  %
  %Top of title is 2.25 in.
  %
  \noindent
  \parbox[b][\TitleBoxHeight][s]{\linewidth}{
  \begin{center}
    \singlespace
    \uppercase\expandafter{\@title}
  \end{center}\vfill}
  %
  %Bottom of "BY" is 4 in.
  %
  \parbox[b][2.50in][s]{\linewidth}{
  \begin{center}
    A Dissertation Presented \\by\\
    \expandafter{\@author}\\
to\\
The Faculty of the Graduate College\\
of\\
The University of Vermont
% \begin{center}\singlespace %\@prevdegrees 
%\end{center}  
\end{center}\vfill}
  %
  %Bottom of "DISSERTATION" is 6.5 in.
  %
  \parbox[b][1.5in][s]{\linewidth}{
  \begin{center}
    \singlespace
    In Partial Fullfillment of the Requirements\\
    for the Degree of \@degreetype\\
    Specializing in \@spectype\\
    \vskip 2em    
    \@gradmonth, \number\@gradyear\par
  \end{center}\vfill}
   \clearpage
}


\def\makeacceptance{%
  \singlespace
 \vspace*{1em}
  \noindent
  Accepted by the Faculty of the Graduate College, The University of
  Vermont, in partial fulfillment of the requirements for the degree of
  \@degreetype, specializing in \@spectype.\par
  \vskip 2.5em
  \noindent
  Thesis Examination Committee:

  \begin{center}
    \begin{tabular}{ll}
      \\ \\ \\
      \hspace{3in} &  Advisor\\
      \cline{1-1} \@advisor & \ \\
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
     %% If you have co-advisors 
     %%   \\ \\ \\
     %% \ & Co-advisor \\
     %% \cline{1-1} \@coadvisorone & \ \\
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      \\ \\ \\
      \ & \ \\
      \cline{1-1} \@readerone & \ \\
      \\ \\ \\
      \ & \ \\
      \@ifundefined{@readertwo}
        {}
        {\cline{1-1} \@readertwo & \ \\
         \\ \\ \\}
      \ & Chairperson\\
      \cline{1-1} \@chair & \ \\
      \\ \\ \\

      \ & Dean, Graduate College \\
      \cline{1-1} Cynthia J. Forehand, Ph.D. & \ \\
      \\ \\ \\
      Date: \@defensedate & \ \\
    \end{tabular}
  \end{center}
  \thispagestyle{empty}
  \newpage
}



%
% redefine abstract environment
%
\renewenvironment{abstract}{
  \chapter*{Abstract}
  \thispagestyle{empty}
  \singlespace
%  \begin{center}
 %   \uppercase\expandafter{\@title}\\
 %   \@author, Ph.D. \\ \singlespace
 %   Department of Physics\\
 %   University of Illinois at Urbana-Champaign, \@gradyear\\
 %   \@advisor, Advisor\\
%  \end{center}
} {
  \pagenumbering{roman}
   \clearpage
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% If a dedication page is needed, you could define dedication 
%% environment as follows. After it is defined, you may use the command
%% \dedication in your main content. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
% define dedication environment
%
\newenvironment{dedication}{
  \vspace*{5in} %% leave 5in plain space from top of the page
  \thispagestyle{empty} %% whether or not to show the page number
  \singlespace
  } {
  \pagenumbering{roman}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
%
% Modify figure captions so that they print singlespace.
%
\renewcommand{\@makecaption}[2]{% #1 is e.g. Figure 1, #2 is captiontext
  \singlespace
  {\textbf{#1:} #2\par}
}

%
% Change some of the rules for float placement.
%
\setcounter{topnumber}{2}           % Maximum 2 floats on top
\setcounter{bottomnumber}{1}        % Maximum 1 float on bottom
\renewcommand{\topfraction}{0.7}    % Top float max size is 70%
\renewcommand{\bottomfraction}{0.7} % Bottom float max size is 70%


%%
%% The following command ``IfSubStringInString'' is taken from the
%% ``substr'' package by Harald Harders:
%%
%% Copyright 2000 Harald Harders
%%
%% This program can be redistributed and/or modified under the terms of the LaTeX Project Public
%% License Distributed from CTAN archives in directory macros/latex/base/lppl.txt; either
%% version 1 of the License, or any later version.
%%
% expands the first and second argument with
% \protected@edef and calls #3 with them:
\newcommand{\su@ExpandTwoArgs}[3]{%
  \protected@edef\su@SubString{#1}%
  \protected@edef\su@String{#2}%
  \expandafter\expandafter\expandafter#3%
  \expandafter\expandafter\expandafter{%
    \expandafter\su@SubString\expandafter
  }\expandafter{\su@String}%
}
%%
%% tests if #1 in #2. If yes execute #3, else #4
\newcommand*{\IfSubStringInString}[2]{%
  \su@ExpandTwoArgs{#1}{#2}\su@IfSubStringInString
}
%%
\newcommand*{\su@IfSubStringInString}[2]{%
  \def\su@compare##1#1##2\@nil{%
    \def\su@param{##2}%
    \ifx\su@param\@empty
      \expandafter\@secondoftwo
    \else
      \expandafter\@firstoftwo
    \fi
  }%
  \su@compare#2#1\@nil
}


%
% Hack ``addcontentsline'' to put ``Chapter'' or ``Appendix'' before the appropriate entry in
% the TOC.
%

\def\addcontentsline#1#2#3{
  \IfSubStringInString{toc}{#1}{
    \IfSubStringInString{\protect\numberline}{#3}{
      \IfSubStringInString{chapter}{#2}{
        \addtocontents{#1}{\protect\contentsline{#2}{\@chapapp\ #3}{\thepage}}
        }
        {\addtocontents{#1}{\protect\contentsline{#2}{#3}{\thepage}}}
    }
    {\addtocontents{#1}{\protect\contentsline{#2}{#3}{\thepage}}}
  }
  {\addtocontents{#1}{\protect\contentsline{#2}{#3}{\thepage}}}
}


%
% End of file uvmdis.sty
%
